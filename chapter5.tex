%----------------------------------------------------------------------------
\chapter{Nyitásérzékelõ}
%----------------------------------------------------------------------------

%----------------------------------------------------------------------------
\section{Specifikáció}
%----------------------------------------------------------------------------

Ezen egység célja hogy egy mágnes közelségét detektálni tudja (Reed kapcsolóval), és bármely érzékelt változást WiFi-n keresztül továbbítsa.
Ennék a modulnál a legnagyobb kihívást az energiagazdálkodás jelenti. A maximális üzemidõt elérendõ, azalatt az idõ alatt, amikor a kapcsoló állapota
nem változik, a központi mikrokontroller mélyalvásban tartózkodik, amibõl csak a állapotváltozásra létrejövõ reset impulzus hatására ébred fel.
Ekkor a modul felcsatlakozik a beállított hálózatra, és értesíti a központi egységet a saját állapotáról. 


%----------------------------------------------------------------------------
\section{Hardver}


\begin{table}[ht]
	\footnotesize
	\centering
	\caption{A környezeti szenzor alkatrész listája}
	\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		& \textbf{Db.} 	& \textbf{Leírás} 	& \textbf{Felh.} 	& \textbf{Gyártó} 	& \textbf{Azonosító} \\ 
		\hline
		1 & 1 & WiFi-s mikrokontroller & U1 & Espressif & ESP8285 \\
		\hline
		2 & 1 & Rezonátor kristály & U2 & Epson & FA-128 26Mhz \\
		\hline
		3 & 1 & Feszültség szabályzó & U4 & Microchip & MIC5353 \\
		\hline
		4 & 1 & Reed kapcsoló & U4 & Hamlin & MACD-14-20-25 \\
		\hline
		5 & 1 & XOR kapu (2) & U4 & TI & SN74LVC2G86DCTR \\
		\hline    
		6 & 1 & Header & P1 & Omron & XG8V-0831 \\ 
		\hline 
		7 & 1 & Akku csatlakozó & J1 & Adafruit  & JST-PH 2-pin \\
		\hline 		
		8 & 1 & Nyomógomb & SW1 & Omron & PTS810 \\
		\hline
		9 & 1 & LED (0603) & D1 & Panasonic & LNJxxx \\
		\hline
		10 & x & Ellenállás (0603) & R1..n & Viking Tech Corp. & - \\
		\hline
		11 & x & Kondenzátor (0603) & C1..n & Yageo, Samsung & - \\
		\hline
	\end{tabular} 
\end{table}

%----------------------------------------------------------------------------

%----------------------------------------------------------------------------
\section{Szofver}
%----------------------------------------------------------------------------

Mivel az eszköz üzemszer\H{u}en nincs bekapcsolva, így tetszõleges idõpontban nem is módosíthatóak a beállításai.
A m\H{u}ködéshez szükséges információk a következõek:

\begin{itemize}  
	\item a WiFi hálózat neve (SSID)
	\item a jelszó
	\item az értesítendõ szerver IP címe
\end{itemize}

Ezek az adatok a mikrokontroller törölhetõ memóriájában kerülnek eltárolásra (EEPROM), maximum 64 byte-on, 0-val jelölve a bejegyzés végét.
A beállítások viszont csak akkor érhetõek el, ha a következõ feltételek valamelyike teljesül:

\begin{itemize}  
	\item a hálózatnév jelszó kettõs érvénytelen (5 másodpercig nem tud csatlakozni)
	\item a szerver nem válaszol
	\item a szerver válasza egy, a setup módba állításra fenntartott kód
\end{itemize}

Ha valamelyik feltétel teljesült, akkor a mikrokontroller egy saját WiFi hozzáférési pontot (access point) nyit,
amire felcsatlakozva elérhetõvé válik a beállításokat tartalmazó \H{u}rlap, aminek kitöltése és elküldése után az eszköz újraindul.





%----------------------------------------------------------------------------
\section{Prototípus}
%----------------------------------------------------------------------------
